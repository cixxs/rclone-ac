# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- main

pool:
  vmImage: ubuntu-latest

steps:
- script: |
    curl -s https://api.myip.la/cn?json
    wget -q https://github.com/jonntd/gclone/releases/download/v1.52.13/gclone_1.52.13_Linux_x86_64.gz
    gunzip gclone_1.52.13_Linux_x86_64.gz
    sudo mv gclone_1.52.13_Linux_x86_64 /usr/bin/gclone
    chmod +x /usr/bin/gclone

    cat >  ~/.config/rclone/rclone.conf  << EOF
    [onedrive]
    type = onedrive
    client_id = fecc7907-889d-4221-be56-b782082e0a6c
    client_secret = MM2T038c_jt_6N_~BksbYY.wW-Su00oC_P
    is_21vianet_version = true
    bwlimit = 100K
    token = {"access_token":"eyJ0eXAiOiJKV1QiLCJub25jZSI6IlZXMDBzMjIwRndOcUdfcFl4Z3E3RXl6MWtzMWdfdzg2bEhGNzdwazRhbEUiLCJhbGciOiJSUzI1NiIsIng1dCI6IkJJR1hIalY5MXNMSlRRbmVJYTN2eEhMY0o3YyIsImtpZCI6IkJJR1hIalY5MXNMSlRRbmVJYTN2eEhMY0o3YyJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy5jaGluYWNsb3VkYXBpLmNuLzFiOWIwNDE4LTY2NDctNGNlOS1hMjQ3LTM0MmZmYjM2NGNiMS8iLCJpYXQiOjE2MDQ0OTYxNzMsIm5iZiI6MTYwNDQ5NjE3MywiZXhwIjoxNjA0NTAwMDczLCJhY3IiOiIxIiwiYWlvIjoiNDJSZ1lOajQ1dVc1ZytkWFcxMmZzVnNqeFZGTTFhYk54RUg4Wjk0ZHcvSnUvcnFiRG53QSIsImFtciI6WyJwd2QiXSwiYXBwX2Rpc3BsYXluYW1lIjoib25lZHJpdmUiLCJhcHBpZCI6ImZlY2M3OTA3LTg4OWQtNDIyMS1iZTU2LWI3ODIwODJlMGE2YyIsImFwcGlkYWNyIjoiMSIsImlwYWRkciI6IjExMS4xOTcuMjUwLjE5NCIsIm5hbWUiOiJTb3JvY2siLCJvaWQiOiI2ZDc1OGI3MC0yNTMxLTQxM2MtYmNjMi1kZWQzNjc1MWQxOTkiLCJwbGF0ZiI6IjMiLCJwdWlkIjoiMTAwMzMyMzBDNTc3RTREOSIsInJoIjoiMC5BQUFBR0FTYkcwZG02VXlpUnpRdi16Wk1zUWQ1elA2ZGlDRkN2bGEzZ2dndUNtd0JBQkkuIiwic2NwIjoiRmlsZXMuUmVhZCBGaWxlcy5SZWFkLkFsbCBGaWxlcy5SZWFkLlNlbGVjdGVkIEZpbGVzLlJlYWRXcml0ZSBGaWxlcy5SZWFkV3JpdGUuQWxsIEZpbGVzLlJlYWRXcml0ZS5BcHBGb2xkZXIgRmlsZXMuUmVhZFdyaXRlLlNlbGVjdGVkIFVzZXIuUmVhZCBwcm9maWxlIG9wZW5pZCBlbWFpbCIsInN1YiI6IlhLTUE5TkRZQmUySWdHOTE5c3lWYXpYYVpNdlpZZzhIWm13bVYxZUh1cUEiLCJ0aWQiOiIxYjliMDQxOC02NjQ3LTRjZTktYTI0Ny0zNDJmZmIzNjRjYjEiLCJ1bmlxdWVfbmFtZSI6IlNvcm9ja0Bjbi5lZHUuZG8iLCJ1cG4iOiJTb3JvY2tAY24uZWR1LmRvIiwidXRpIjoiU3RpUGpsZzZRazZfVDlkNHpNdzJBQSIsInZlciI6IjEuMCIsIndpZHMiOlsiYjc5ZmJmNGQtM2VmOS00Njg5LTgxNDMtNzZiMTk0ZTg1NTA5Il0sInhtc19zdCI6eyJzdWIiOiJzM1Z2UVhaZ0xreGFadG9yZHNJRDBqeS00VnJKaVM3SmJJTFVNVENQRHJVIn0sInhtc190Y2R0IjoxNTgxMzAxNDI5fQ.ATFCZ3NkP0JjLVUeoEsYmJtp9bqkkug-gBrMVfiUmNFmbGtdpZTve68ROkT9XGqMM1eaQmVTHhtlNdfj-exerWqitwbrTtqjpTWrH1iWk8AvW8kTax741G2k_eSrA2O70sY-iAGv2mLRl22yMgpOvQ0aGTdTcm7k4FB281qhd79L84iVBE_NccDH6isB6YoESwr41UqpE3ZzyzlmleyIsfs5BBSXXIv7QzPv6a8Yj5SEBCXlQi93XEXm1I1kWT7mXnpoDyqTYYcKLl6cFVyvxvLO9qxFrsl0jLafvVqDAtcXgSNu4rY6tM13w706C3CLcHZ2wgGZHS-J40HDUYLXRw","token_type":"Bearer","refresh_token":"0.AAAAGASbG0dm6UyiRzQv-zZMsQd5zP6diCFCvla3ggguCmwBABI.AQABAAAAAAAA2xsa-zUZSpZL3C5ZKV2z0B1-UToCDkBbEDrSzcR59QxR6B2A-hyX7Em4nHQo_PMSdVkiVTzhUi9CTol0BNVhAtQW3etrvy6M6824FJH8SyTECa8dxdvOFM9OIOq_XNStQr3ajTHYhQx1Watz3bioqqYxLcrofkDQyMV6BZEAptypUJh_9K3aJYQLykOCr1W1tTbY2fMh_ndkpWDM7w1GCdFVE-z1bvy7xN0hnTRk8NG6B_wkqXzY7hda1wCe50tT-9YVzMNx0-p5pMtYJi9iOwNdYVSdUge7_95bnIez4fIdC_A5kv09af1P6v3zPLgO7pt3qw6WYOSNMGG8MrJX2dqG4MkxYY39_iloCwuDB6PKunUdIIaNqSRRgBQxh6wSZhz9jTFAKCeyEdKrfzyJx2y3TbABoEMt_PxaNjDHzludShY3ze3uYAN91e7Xx0MHf3or498XYrZti21M6RCmfFWSuC3fXZ-4J8WYl9fERGvNq2pq3NdDILxLFriPrz2aQJKA7EW3EC3oPYa0T4Th8iK9yj-czQdLeLb1B8iG6GOO4zogCFI3E7UIvX4QVTnWGRUQTeaOuQjbhEZC5Ehv-rwZ_a78RQ4eUaHlBA4gsYQlqUxbwf7fKiltR7nnxa0WMFx3bXqWC2gavpIZAbG97SZOiDjJz4_iKBGsWi1WjI7wCG-IzAMVaKOt5crWUaDcUzr8AAySRi5zMcR6X-DWBp9hntmaRpzlMsT9pOL05jPWT8Nn7MDEZzWTFtzFLfEGkhHofegyF1woAxCBj8sb_mzY_KgC81cGnsB_wkb0Z43kEOjhYBRiSv2jsTN3D6Zg52zx0lVQgoIcbzKY_nc_2FEKv3O828cP5EbYhue-gCwcrzv2vGOFxfgaN-L5AgogAA","expiry":"2020-11-04T14:27:52.885271967Z"}
    drive_id = b!aaB1vwk1y0KoEtcSO01Bw43n6cQWO7ZOq66TNNInG3EtYFn-rbTsRoTQoDFDyy4J
    drive_type = business

    [onedrive2]
    type = onedrive
    client_id = fecc7907-889d-4221-be56-b782082e0a6c
    client_secret = MM2T038c_jt_6N_~BksbYY.wW-Su00oC_P
    is_21vianet_version = true
    token = {"access_token":"eyJ0eXAiOiJKV1QiLCJub25jZSI6Im55LVZ3WnVhWWNkbFIzaEdpS0JhaHB2QTlQQ183VldGanRwU3JyRkpUaGciLCJhbGciOiJSUzI1NiIsIng1dCI6Il9DSkFPdHlzWVZtNXhjMVlvSzBvUTdxeUJDUSIsImtpZCI6Il9DSkFPdHlzWVZtNXhjMVlvSzBvUTdxeUJDUSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy5jaGluYWNsb3VkYXBpLmNuLzFiOWIwNDE4LTY2NDctNGNlOS1hMjQ3LTM0MmZmYjM2NGNiMS8iLCJpYXQiOjE2MTY5Mzk3NzksIm5iZiI6MTYxNjkzOTc3OSwiZXhwIjoxNjE2OTQzNjc5LCJhY3IiOiIxIiwiYWlvIjoiNDJKZ1lHalgxVmpVTGZIN0VJK3VZWEN6NElQcmJIY2VyOVI2cTNSeVliZXRSUTlMeVcwQSIsImFtciI6WyJwd2QiXSwiYXBwX2Rpc3BsYXluYW1lIjoib25lZHJpdmUiLCJhcHBpZCI6ImZlY2M3OTA3LTg4OWQtNDIyMS1iZTU2LWI3ODIwODJlMGE2YyIsImFwcGlkYWNyIjoiMSIsImlwYWRkciI6IjEwNi4zNy44MC4xNDYiLCJuYW1lIjoiU29yb2NrMiIsIm9pZCI6ImU2YjVjYmFhLTE3ZDktNGM3OC1iMWE5LTZiNjJiNzE4ZjczMiIsInBsYXRmIjoiMyIsInB1aWQiOiIxMDAzMzIzMEM1Q0FCMDEzIiwicmgiOiIwLkFBQUFHQVNiRzBkbTZVeWlSelF2LXpaTXNRZDV6UDZkaUNGQ3ZsYTNnZ2d1Q213QkFMby4iLCJzY3AiOiJGaWxlcy5SZWFkIEZpbGVzLlJlYWQuQWxsIEZpbGVzLlJlYWQuU2VsZWN0ZWQgRmlsZXMuUmVhZFdyaXRlIEZpbGVzLlJlYWRXcml0ZS5BbGwgRmlsZXMuUmVhZFdyaXRlLkFwcEZvbGRlciBGaWxlcy5SZWFkV3JpdGUuU2VsZWN0ZWQgVXNlci5SZWFkIHByb2ZpbGUgb3BlbmlkIGVtYWlsIiwic3ViIjoiZm1KYnM4VDJQeVJaWkNjU0g5OTFaQk95aW5SemJ3b0pQLVJNNFQ4QjBvUSIsInRpZCI6IjFiOWIwNDE4LTY2NDctNGNlOS1hMjQ3LTM0MmZmYjM2NGNiMSIsInVuaXF1ZV9uYW1lIjoiU29yb2NrMkBjbi5lZHUuZG8iLCJ1cG4iOiJTb3JvY2syQGNuLmVkdS5kbyIsInV0aSI6InV1amtLVlBoYTBtbGxBRWE2UUFXQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfc3QiOnsic3ViIjoiNHB1LWtIV3h2NWxzUnZwckh1bkV2d1lFZk52OENocXh1Z3ZxbERmazlJbyJ9LCJ4bXNfdGNkdCI6MTU4MTMwMTQyOX0.PjzYN3WFNE6CcI-eNuk-HR_C-IUOS-zTC48THTcQY11ix6jQSHFxKDADcenw65x6MfeBSArGMF-FxebqXHlIfenjpTHY0Lgi5aWrOJXhE_xukFVb_CqGt73bv-coV8uz7Zt_WSndK4nXw3lZYOPp4w2ln8lTZwldm7dov-L30aJTzBeDcNiMBXk6dMS7fGvzt-I9Bml3AiGmH1pyyQR1ONMJ-64wtKMOW9QOt9yxAfu2t5Ygvfd2sjm9Cy6Z98zd_WWhjL5lLUad__w741IQ0LZX9qHU0LQNmRGnmRIJp0T31xLD738PreazY64kCT1inAMe4wVY0jd7__2F5Um4-g","token_type":"Bearer","refresh_token":"0.AAAAGASbG0dm6UyiRzQv-zZMsQd5zP6diCFCvla3ggguCmwBALo.AQABAAAAAADF8uhbdqMKTqrrFtoyDhmYqs1wIzAzc2JA3cB5FslFvwiWIL6UQyWGE37binr7aFruGjPKGlDiZHsz0C2nj2JE7ZqFnAc9ZLpGJPzthRWC1Y85g1Im7Xa6e_jIR98TNb_E_ImYcVkgqtnhYfkOgFbVTw5jq3x7iyPG2AfJPNj0WroLIbviNIMkUxbaUiGcQQg0zKHe6toKXrNWT7et6kmoPdbeDGFBIX79Hf6abvEU9dg2D-8AS8NPGSh3zz4VSHYc_7i_u5ihdGeClCKkg0fXRn-T2KtIuIuu9fkYsFte-HnAHrirYR-b3xQ2sg9sXPY450jpGEAvrNh9qmJC4UFcSlz8W1TnkfKwpiKiD5SUB3pXWT--adE1duxcO_gCg1RYOfiq_hbRpBRMFkd1TDUyd4jmZxkgTaRsYSL3Oev8fQe8Un4DlNZ5Lk4d-Sle3_z6DaRSqF3Q5PUPYTogvR9mSiSmF-9x7uhjvTyrSqYcFLZ6GuNGR58sOJ8JJrSyZV9XtuDcdD5u_uueRajVtKR0K5li3LqoseEwE6el1qEeLH_wFjV9tQvtFQ87NBrwdblFz_iVQSGWAyZKKvf4d0dB7xV9cRjRaJ6i-sPJu1LX6_Mxjm_-SRaVojdh99QysjiK0MziHARqvmxVfdIO_9pzBqE7kqXv3GgXc-XAVfkrzfKXFdhiqr6CIckxWTs1XojUEuyQ-NLfpkozKf50W-LtxvFDAxtwml9uaXHMynq6P6_uW47Az6jxmtiOje2NkyTeuG7Pe9zfQbLZuhzMoiy0oR8_IWokzpdRUgSDtBAt1D0HsfoXNAxJCRqlQwr0duWVZ_Iirw7Ecv4u516Oy3ZY6sMmLSLkZo1Tu69eS6EFt8VeKA-prow86CWaYp_62D0gAA","expiry":"2021-03-28T23:01:19.094944755+08:00"}
    drive_id = b!aUMkGZeB5Eee4v_melSU9f-6xXFDOxpNl9pDtABbhtdgaUYPCex3QovoU5fFe0nN
    drive_type = business

    [gdrive]
    type = drive
    client_id = 701801520433-klhgds8kqag1jiejmat9iqai27lhdilg.apps.googleusercontent.com
    client_secret = GSnaPzt-S2AujrnweBoIHrsz
    scope = drive
    token = {"access_token":"ya29.a0AfH6SMBkHo_3M46neYq5k6fqg-bvbYaCmH4_H67amTCUMfg9nxKA2f5_xNCWR4CFycHSKKGfqowXCcY4uMEQ5GKmSIyWct2BtDDDqiFx5QuLA3C6I0ndi7t8JfX8Ijc9edw-N2JSWiam2qOBbCRJcND_b6CnXH0","token_type":"Bearer","refresh_token":"1//0ecwe9ts1rMaSCgYIARAAGA4SNwF-L9IrGhoSv4hEvF9fZMCXz4X9zNWkzngM107-2AwOjsSpia5Co-rKCNt-jxVmPbhfLLaDNVE","expiry":"2021-03-28T22:01:18.690999681+08:00"}
    root_folder_id = 0APXcS2J10fK5Uk9PVA

    EOF
    
    gclone copy gdrive:Multimedia/JAV/Drama onedrive2:Multimedia/Drama --max-backlog 1000 --stats-log-level NOTICE -P --stats 30s --size-only --cache-chunk-total-size 20G --transfers=10 --onedrive-chunk-size 250M --drive-chunk-size 256M
    gclone copy gdrive:Multimedia/JAV/S-Cute onedrive2:Multimedia/S-Cute --max-backlog 1000 --stats-log-level NOTICE -P --stats 30s --size-only --cache-chunk-total-size 20G --transfers=10 --onedrive-chunk-size 250M --drive-chunk-size 256M

  displayName: 'Run a multi-line script'